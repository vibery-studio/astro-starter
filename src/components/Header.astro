---
/**
 * Header with glassmorphism on scroll effect
 * Vietnamese navigation labels
 */
import { SITE_TITLE } from '../consts';
import { getPath } from '../utils/paths';

const navItems = [
	{ href: '/', label: 'Trang chủ' },
	{ href: '/about', label: 'Về chúng tôi' },
	{ href: '/blog', label: 'Blog' },
	{ href: '/contact', label: 'Liên hệ' },
];
---

<header id="main-header">
	<nav class="container" aria-label="Điều hướng chính">
		<a href={getPath('/')} class="logo" aria-label={SITE_TITLE}>
			<span class="logo-text">{SITE_TITLE}</span>
		</a>

		<button
			class="mobile-toggle"
			aria-label="Mở menu"
			aria-expanded="false"
			aria-controls="nav-menu"
		>
			<span class="hamburger"></span>
		</button>

		<ul id="nav-menu" class="nav-links">
			{navItems.map((item) => (
				<li>
					<a href={getPath(item.href)} class="nav-link">
						{item.label}
					</a>
				</li>
			))}
		</ul>
	</nav>
</header>

<script>
	// Scroll-based glassmorphism
	const header = document.getElementById('main-header');
	let lastScroll = 0;

	function updateHeader() {
		const scroll = window.scrollY;
		if (scroll > 50) {
			header?.classList.add('scrolled');
		} else {
			header?.classList.remove('scrolled');
		}
		lastScroll = scroll;
	}

	// Mobile menu toggle
	const toggle = document.querySelector('.mobile-toggle');
	const navMenu = document.getElementById('nav-menu');

	toggle?.addEventListener('click', () => {
		const expanded = toggle.getAttribute('aria-expanded') === 'true';
		toggle.setAttribute('aria-expanded', String(!expanded));
		navMenu?.classList.toggle('open');
		toggle.setAttribute('aria-label', expanded ? 'Mở menu' : 'Đóng menu');
	});

	window.addEventListener('scroll', updateHeader, { passive: true });
	updateHeader();
</script>

<style>
	header {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		z-index: 100;
		background: var(--color-white);
		transition: all var(--transition-base);
	}

	header.scrolled {
		background: rgba(255, 255, 255, 0.85);
		backdrop-filter: blur(20px);
		-webkit-backdrop-filter: blur(20px);
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
	}

	nav {
		display: flex;
		align-items: center;
		justify-content: space-between;
		padding: var(--space-4) var(--section-padding-x);
		max-width: var(--container-xl);
		margin: 0 auto;
	}

	.logo {
		text-decoration: none;
		display: flex;
		align-items: center;
		gap: var(--space-2);
	}

	.logo-text {
		font-family: var(--font-heading);
		font-size: var(--text-xl);
		font-weight: var(--font-bold);
		color: var(--color-primary);
	}

	.nav-links {
		display: flex;
		align-items: center;
		gap: var(--space-8);
		list-style: none;
		margin: 0;
		padding: 0;
	}

	.nav-link {
		position: relative;
		font-size: var(--text-base);
		font-weight: var(--font-medium);
		color: var(--color-neutral-700);
		text-decoration: none;
		padding: var(--space-2) 0;
		transition: color var(--transition-fast);
	}

	.nav-link::after {
		content: '';
		position: absolute;
		bottom: 0;
		left: 0;
		width: 100%;
		height: 2px;
		background: var(--color-primary);
		transform: scaleX(0);
		transform-origin: left;
		transition: transform var(--transition-base);
	}

	.nav-link:hover {
		color: var(--color-primary);
	}

	.nav-link:hover::after {
		transform: scaleX(1);
	}

	/* Mobile toggle */
	.mobile-toggle {
		display: none;
		background: none;
		border: none;
		padding: var(--space-2);
		cursor: pointer;
	}

	.hamburger {
		display: block;
		width: 24px;
		height: 2px;
		background: var(--color-neutral-700);
		position: relative;
		transition: background var(--transition-fast);
	}

	.hamburger::before,
	.hamburger::after {
		content: '';
		position: absolute;
		left: 0;
		width: 100%;
		height: 2px;
		background: var(--color-neutral-700);
		transition: transform var(--transition-base);
	}

	.hamburger::before { top: -8px; }
	.hamburger::after { top: 8px; }

	.mobile-toggle[aria-expanded="true"] .hamburger {
		background: transparent;
	}

	.mobile-toggle[aria-expanded="true"] .hamburger::before {
		transform: rotate(45deg) translate(6px, 6px);
	}

	.mobile-toggle[aria-expanded="true"] .hamburger::after {
		transform: rotate(-45deg) translate(6px, -6px);
	}

	/* Mobile styles */
	@media (max-width: 768px) {
		.mobile-toggle {
			display: block;
		}

		.nav-links {
			position: absolute;
			top: 100%;
			left: 0;
			right: 0;
			flex-direction: column;
			gap: 0;
			background: var(--color-white);
			box-shadow: var(--shadow-lg);
			opacity: 0;
			visibility: hidden;
			transform: translateY(-10px);
			transition: all var(--transition-base);
		}

		header.scrolled .nav-links {
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(20px);
		}

		.nav-links.open {
			opacity: 1;
			visibility: visible;
			transform: translateY(0);
		}

		.nav-links li {
			width: 100%;
		}

		.nav-link {
			display: block;
			padding: var(--space-4) var(--section-padding-x);
			border-bottom: 1px solid var(--color-border-light);
		}

		.nav-link::after {
			display: none;
		}
	}

	/* Reduced motion */
	@media (prefers-reduced-motion: reduce) {
		header,
		.nav-link,
		.nav-link::after,
		.hamburger,
		.hamburger::before,
		.hamburger::after,
		.nav-links {
			transition: none;
		}
	}
</style>
